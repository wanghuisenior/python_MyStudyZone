/* 
 * easyDialog v1.0
 * http://stylechen.com/easydialog.html
 * Date : 2011-03-23
 */
(function(){var a=function(){var l=window.document,j=l.body,e=!-[1,],h=!-[1,]&&!window.XMLHttpRequest,m={},f,d;var k=function(){this.defaults={container:null,isOverlay:true,fixed:true,follow:null,followX:0,followY:0,autoClose:0,callback:null}};k.prototype={getOptions:function(n){var o={},p;for(p in this.defaults){o[p]=n[p]!==undefined?n[p]:this.defaults[p]}return o},setBodyBg:function(){if(j.currentStyle.backgroundAttachment!=="fixed"){j.style.backgroundImage="url(about:blank)";j.style.backgroundAttachment="fixed"}},appendIframe:function(n){n.innerHTML='<iframe style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;border:0 none;filter:alpha(opacity=0)"></iframe>'},removeNode:e?function(){var n;return function(o){n=n||document.createElement("div");n.appendChild(o);n.innerHTML=""}}():function(n){n.parentNode.removeChild(n)},getOffset:function(n){var p=e?n.getBoundingClientRect().top+l.documentElement.scrollTop:n.offsetTop,o=e?n.getBoundingClientRect().left+l.documentElement.scrollLeft:n.offsetLeft;return{top:p,left:o}}};var i=new k();var g=function(){var n;return(function(){n=n||l.createElement("div");n.style.cssText="margin:0;padding:0;border:none;width:100%;height:100%;background:#333;opacity:0.6;filter:alpha(opacity=60);z-index:1000;position:fixed;top:0;left:0;";if(h){j.style.height="100%";n.style.position="absolute";n.style.setExpression("top",'fuckIE6=document.documentElement.scrollTop+"px"')}n.id="overlay";return n})()};var c=function(){var n;return(function(){n=n||l.createElement("div");n.style.cssText="margin:0;padding:0;border:none;z-index:1001;";var o=function(p){n.style.top=(i.getOffset(p).top+m.followY)+"px";n.style.left=(i.getOffset(p).left+m.followX)+"px";m.fixed=false;m.isOverlay=false};if(typeof m.follow==="string"){o(document.getElementById(m.follow))}else{if(!!m.follow&&typeof m.follow==="object"){o(m.follow)}else{n.style.top="50%";n.style.left="50%"}}if(m.fixed){if(h){n.style.position="absolute";n.style.setExpression("top",'fuckIE6=document.documentElement.scrollTop+document.documentElement.clientHeight/2+"px"')}else{n.style.position="fixed"}}else{n.style.position="absolute";if(m.follow===null){n.style.top=(l.documentElement.clientHeight/2+Math.max(l.documentElement.scrollTop,j.scrollTop))+"px";n.style.left=(l.documentElement.clientWidth/2+Math.max(l.documentElement.scrollLeft,j.scrollLeft))+"px";window.onresize=function(){n.style.top=(l.documentElement.clientHeight/2+Math.max(l.documentElement.scrollTop,j.scrollTop))+"px";n.style.left=(l.documentElement.clientWidth/2+Math.max(l.documentElement.scrollLeft,j.scrollLeft))+"px"}}}n.id="dialog_box";return n})()};var b={open:function(){if(l.getElementById("dialog_box")){b.close()}m=i.getOptions(arguments[0]);var p=c();if(m.isOverlay){var o=g();j.appendChild(o);if(h){i.appendIframe(o)}}if(h){i.setBodyBg()}j.appendChild(p);if(typeof m.container==="string"){f=document.getElementById(m.container);if(h&&!m.isOverlay){i.appendIframe(p)}p.appendChild(f);f.style.display="block";var n=f.offsetWidth,q=f.offsetHeight;f.style.marginTop=f.style.marginRight=f.style.marginBottom=f.style.marginLeft="0px";if(!m.follow){p.style.marginLeft="-"+n/2+"px";p.style.marginTop="-"+q/2+"px"}if(h&&!m.isOverlay){p.style.width=n+"px";p.style.height=q+"px"}}if(m.autoClose&&typeof m.autoClose==="number"){d=setTimeout(function(){b.close();clearTimeout(d)},m.autoClose)}l.onkeyup=function(r){r=r||window.event;if(r.keyCode===27){b.close()}}},close:function(){l.onkeyup=null;if(document.getElementById("overlay")){i.removeNode(l.getElementById("overlay"))}f.style.display="none";j.appendChild(f);i.removeNode(l.getElementById("dialog_box"));if(typeof m.callback==="function"){m.callback()}}};return b};window.easyDialog=a()})();
